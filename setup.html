<!DOCTYPE html>
<html>
<head>
    <title>Face ID Generator (CDN Version)</title>
    <script src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>
    <style>
        body { background: #1a1a1a; color: white; text-align: center; font-family: sans-serif; padding: 20px; }
        #status { color: #aaa; margin-bottom: 20px; }
        textarea { width: 90%; height: 100px; background: #222; color: #00ff88; border: 1px solid #444; margin-top: 10px; }
        
        /* Main Action Buttons */
        .btn { padding: 15px 30px; font-size: 18px; cursor: pointer; border: none; border-radius: 8px; margin-top: 10px; color: white; font-weight: bold; }
        #scanBtn { background: #007aff; display:none; }
        #copyBtn { background: #28a745; display:none; } /* Green Copy Button */
        
        video { border: 2px solid #555; border-radius: 10px; display:none; max-width: 100%; }
    </style>
</head>
<body>
    <h2>Scholar Zolo Setup</h2>
    <div id="status">Connecting to AI Cloud...</div>
    <video id="video" autoplay muted playsinline></video>
    <br>
    
    <button id="scanBtn" class="btn" onclick="scanFace()">ðŸ“¸ Scan Face</button>
    
    <br><br>
    <textarea id="result" placeholder="Your numbers will appear here..." readonly></textarea>
    <br>

    <button id="copyBtn" class="btn" onclick="copyText()">ðŸ“‹ Copy to Clipboard</button>

    <script>
        const status = document.getElementById('status');
        const copyBtn = document.getElementById('copyBtn');
        
        async function loadModels() {
            try {
                const MODEL_URL = 'https://justadudewhohacks.github.io/face-api.js/models';
                status.innerText = "Downloading Brains from Cloud...";
                
                await faceapi.nets.tinyFaceDetector.loadFromUri(MODEL_URL);
                await faceapi.nets.faceLandmark68Net.loadFromUri(MODEL_URL);
                await faceapi.nets.faceRecognitionNet.loadFromUri(MODEL_URL);

                status.innerText = "Ready! Starting Camera...";
                startCamera();
            } catch (err) {
                status.innerText = "Error: " + err.message;
                status.style.color = "red";
            }
        }

        async function startCamera() {
            const stream = await navigator.mediaDevices.getUserMedia({ video: {} });
            document.getElementById('video').srcObject = stream;
            document.getElementById('video').style.display = "inline-block";
            document.getElementById('scanBtn').style.display = "inline-block";
            status.innerText = "Look at camera & click Scan.";
        }

        async function scanFace() {
            status.innerText = "Scanning...";
            const detection = await faceapi.detectSingleFace(document.getElementById('video'), new faceapi.TinyFaceDetectorOptions())
                .withFaceLandmarks()
                .withFaceDescriptor();

            if (detection) {
                // Fill the text box
                document.getElementById('result').value = JSON.stringify(Object.values(detection.descriptor));
                
                // Show Success & The Copy Button
                status.innerText = "âœ… Success! Click Copy below.";
                status.style.color = "#00ff88";
                copyBtn.style.display = "inline-block"; 
            } else {
                status.innerText = "âŒ No face found. Try again.";
                status.style.color = "orange";
            }
        }

        function copyText() {
            const resultBox = document.getElementById('result');
            
            // Select text (Mobile friendly)
            resultBox.select();
            resultBox.setSelectionRange(0, 99999); 

            // Copy command
            navigator.clipboard.writeText(resultBox.value).then(() => {
                const originalText = copyBtn.innerText;
                copyBtn.innerText = "âœ… COPIED!";
                copyBtn.style.background = "#005500"; // Darker green
                
                // Reset button text after 2 seconds
                setTimeout(() => {
                    copyBtn.innerText = originalText;
                    copyBtn.style.background = "#28a745";
                }, 2000);
            });
        }

        loadModels();
    </script>
</body>
</html>